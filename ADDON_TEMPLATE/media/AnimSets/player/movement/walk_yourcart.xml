<?xml version="1.0" encoding="utf-8"?>
<!--
    WALK ANIMATION TEMPLATE FOR CUSTOM CARTS

    CRITICAL REQUIREMENTS:

    1. m_Priority AND m_ConditionPriority MUST be set (e.g., 10)
       - Without this, your node AND vanilla defaultWalk can BOTH activate
       - This causes animation blending issues and can block movement entirely
       - The game sorts nodes by conditionPriority (descending), then condition count
       - Your node needs higher priority than vanilla (which defaults to 0)

    2. x_extends works against VANILLA files loaded by the game
       - DO NOT copy vanilla files to your mod folder - they will be SKIPPED!
       - The game loads vanilla first, then skips mod files with matching paths
       - Your custom files with DIFFERENT names are loaded and extend vanilla

    3. m_2DBlends MUST have COMPLETE configurations with ALL properties:
       - referenceID (must match parent's blend node numbering)
       - m_AnimName (your animation name)
       - m_XPos, m_YPos (blend space coordinates)
       - m_SpeedScale (animation playback speed)

    Replace "YourCart" with your cart name throughout this file.
    Replace "Bob_YourCart_Walk" with your actual walk animation name.
-->
<animNode x_extends="defaultWalk.xml">
    <!-- Node name - must be unique, used in transitions -->
    <m_Name>walkYourCart</m_Name>

    <!-- Default animation for this state -->
    <m_AnimName>Bob_YourCart_Walk</m_AnimName>

    <!-- CRITICAL: Priority settings to win over vanilla nodes -->
    <m_Priority>10</m_Priority>
    <m_ConditionPriority>10</m_ConditionPriority>

    <!-- Speed settings (vanilla pattern) -->
    <m_SpeedScale>1.04</m_SpeedScale>
    <m_Scalar>WalkInjury</m_Scalar>
    <m_Scalar2>WalkSpeed</m_Scalar2>

    <!-- Root motion axis: Z reads Y-forward from Blender exports -->
    <m_deferredBoneAxis>Z</m_deferredBoneAxis>

    <!--
        2D BLEND SPACE NODES

        These define how the animation blends based on movement direction and speed.
        The XPos/YPos create a 2D grid:
        - YPos: 0.0 = slow walk, 1.0 = fast walk
        - XPos: -1.0 = strafe left, 0.0 = forward, 1.0 = strafe right

        IMPORTANT: Match the number of blend nodes to the parent (defaultWalk.xml has 6)
    -->

    <!-- Blend 1: Slow forward walk -->
    <m_2DBlends referenceID="1">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>0.00</m_XPos>
        <m_YPos>0.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!-- Blend 2: Slow strafe right -->
    <m_2DBlends referenceID="2">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>0.50</m_XPos>
        <m_YPos>0.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!-- Blend 3: Slow strafe left -->
    <m_2DBlends referenceID="3">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>-0.50</m_XPos>
        <m_YPos>0.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!-- Blend 4: Fast forward walk -->
    <m_2DBlends referenceID="4">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>0.00</m_XPos>
        <m_YPos>1.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!-- Blend 5: Fast strafe right -->
    <m_2DBlends referenceID="5">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>0.50</m_XPos>
        <m_YPos>1.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!-- Blend 6: Fast strafe left -->
    <m_2DBlends referenceID="6">
        <m_AnimName>Bob_YourCart_Walk</m_AnimName>
        <m_XPos>-0.50</m_XPos>
        <m_YPos>1.00</m_YPos>
        <m_SpeedScale>0.80</m_SpeedScale>
    </m_2DBlends>

    <!--
        CONDITION: When to use this animation
        Weapon = "yourcart" is set by your Lua code when player equips the cart
    -->
    <m_Conditions>
        <m_Name>Weapon</m_Name>
        <m_Type>STRING</m_Type>
        <m_Value>yourcart</m_Value>
    </m_Conditions>

    <!-- Prevent activation during turn-around (inherited behavior) -->
    <m_Conditions>
        <m_Name>isTurningAround</m_Name>
        <m_Type>BOOL</m_Type>
        <m_Value>false</m_Value>
    </m_Conditions>

    <!--
        TRANSITIONS: Where this state can go
        blendInTime controls how smoothly it transitions (in seconds)
    -->
    <m_Transitions>
        <m_Target>IdleYourCart</m_Target>
        <m_blendInTime>0.3</m_blendInTime>
    </m_Transitions>
    <m_Transitions>
        <m_Target>runYourCart</m_Target>
        <m_blendInTime>0.3</m_blendInTime>
    </m_Transitions>
    <m_Transitions>
        <m_Target>sprintYourCart</m_Target>
        <m_blendInTime>0.3</m_blendInTime>
    </m_Transitions>

    <!-- Footstep sounds (vanilla timing: 0.20 and 0.65) -->
    <m_Events>
        <m_EventName>Footstep</m_EventName>
        <m_TimePc>0.20</m_TimePc>
        <m_ParameterValue>walk</m_ParameterValue>
    </m_Events>
    <m_Events>
        <m_EventName>Footstep</m_EventName>
        <m_TimePc>0.65</m_TimePc>
        <m_ParameterValue>walk</m_ParameterValue>
    </m_Events>
</animNode>
